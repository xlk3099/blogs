---
title: "Eth Explorer Summary：以太坊浏览器开发心得"
date: 2018-09-27T10:14:13+08:00
draft: true
---

从Evernote工作笔记上来看，开始着手调研以太坊浏览器是3月底，正式开始设计实现浏览器是4月份，到现在浏览器开发，parser 跟ethx 两个模块，也差不多正好半年。

中间真的学习到了很多，写个总结记录下中间踩到的坑。

初版

初版的主要设计需求：

1. 支持获取blocks，transactions, uncles, erc20 transactions 等链上数据。
2. 能准确同步历史数据。
3. 能监听最新block。
4. 能监听最新的tx pool。

关于获取链上历史数据部分，一开始看了[BlockSci](https://github.com/citp/BlockSci)受了启发，了解到获取历史数据主要有两种方式

1. 通过rpc直接从节点获取
2. 通过读取节点数据库

方法二不用说肯定是最高效的，比方法一省了一个跟节点1交互的过程。
也是我一开始主攻方向。大概花了一天时间总算能从节点数据库里面获得自己感兴趣的数据，但刚出炉的方法没捂热，就很悲剧的发现，节点数据库采用的是`levelDB`，
只支持单进程访问。

好吧...哔了狗了...

方法二-> 卒。。

于是转攻方法一: `所有的数据都是直接通过rpc访问parity获取`

方法一表现的还不错，速度还行，通过测试网挖掘速度可以啊，单线程大概每秒得有30个block的import，再算算600万/30/3600 差不多得55个小时，我心里就不开心了...

`加多线程`，加多少

初版的自己是real耿直，
通过rpc能得到链上数据
一开始是real耿直，虽然听说过MySQL事务模型，ACID 原子写入，但没用，

当时parser部分采用了：

1. goroutine workers pool
2. 多线程写入MySQL
3. 多线程从Parity拿取数据

初版的设计很简单，历时差不多一个月从设计到实现。
